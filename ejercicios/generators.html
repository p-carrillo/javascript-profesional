<html>
  <head>
    <title>Proxy</title>
  </head>

  <body>
    <a href="/ejercicios/">Go back</a>
    <p><em>Abre la consola</em></p>

    <script>
      /**
       * Los generadores son funciones de las que se puede salir y volver a entrar
       * Su contexto, asociacion de variables,sera conservado entre entradas
       * Cada vez que llamamos anext, la ejecucion del generador va a continuar hasta el proximo yield
       */

       function* simpleGenerator() {
        console.log('GENERATOR START');
        yield 1;
        yield 2;
        yield 3;
        console.log('GENERATOR ENDS')

       }

       // Las funiones generador no son ejecuables por si mimmas, una vez dentro de una variable podremos utilizar la variable para ejecutar el generador.

       const gen = simpleGenerator();

       console.log('Generador basico');
       
       console.log(gen.next())
       console.log(gen.next())
       console.log(gen.next())
       console.log(gen.next())

      //Podemos hacer generadores infinitos:

      function* idMaker() {
        let id = 1
        while(true) {
          yield id
          id = id + 1
        }
      }

      const gen2 = idMaker()

      console.log('Generador con bucle');

      console.log(gen2.next());
      console.log(gen2.next());
      console.log(gen2.next());
      console.log(gen2.next());

      // Podemos pasarle variables al generador:

      function* idMakerWithReset() {
        let id = 1
        let reset
        while(true) {
          reset = yield id
          if (reset) {
            id = 1
          } else {
            id = id + 1
          }  
        }
      }

      const gen3 = idMakerWithReset()

      console.log('Generador con reset');

      console.log(gen3.next());
      console.log(gen3.next());
      console.log(gen3.next(true));
      console.log(gen3.next());
      console.log(gen3.next());

      // Fibonacci

      function* fibonacci() {
        let a = 1
        let b = 1
        let reset
        while(true) {
          reset = yield a
          if (reset) {
            a = 1
            b = 1
          } else {
            nextNumber = a + b;
            a = b;
            b = nextNumber;
          }
        }
      }

      const genFibo = fibonacci();

      console.log('Generador Fibonacci');

      
      for ( let i = 1; i < 100; i++ ) {
        console.log(genFibo.next())
      }

    </script>
  </body>
</html>
